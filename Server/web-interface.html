<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>ü§ñ AI-Enhanced Clash Bot Interface</title>
		<style>
			* {
				box-sizing: border-box;
				margin: 0;
				padding: 0;
			}

			body {
				font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
				line-height: 1.6;
				color: #333;
				background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
				min-height: 100vh;
			}

			.container {
				max-width: 1200px;
				margin: 0 auto;
				padding: 20px;
			}

			.header {
				text-align: center;
				color: white;
				margin-bottom: 30px;
			}

			.header h1 {
				font-size: 2.5em;
				margin-bottom: 10px;
			}

			.endpoint-grid {
				display: grid;
				grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
				gap: 20px;
				margin-bottom: 30px;
			}

			.endpoint-card {
				background: white;
				border-radius: 10px;
				padding: 20px;
				box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
				transition: transform 0.3s ease;
			}

			.endpoint-card:hover {
				transform: translateY(-5px);
			}

			.endpoint-card h3 {
				color: #667eea;
				margin-bottom: 15px;
				font-size: 1.3em;
			}

			.endpoint-card p {
				margin-bottom: 15px;
				color: #666;
			}

			.test-button {
				background: linear-gradient(45deg, #667eea, #764ba2);
				color: white;
				border: none;
				padding: 12px 24px;
				border-radius: 5px;
				cursor: pointer;
				font-size: 1em;
				transition: all 0.3s ease;
				width: 100%;
			}

			.test-button:hover {
				background: linear-gradient(45deg, #5a6cdc, #6a4190);
				transform: translateY(-2px);
			}

			.test-button:disabled {
				background: #ccc;
				cursor: not-allowed;
				transform: none;
			}

			.response-area {
				margin-top: 15px;
				background: #f8f9fa;
				border-radius: 5px;
				padding: 15px;
				display: none;
				max-height: 300px;
				overflow-y: auto;
			}

			.response-area.show {
				display: block;
			}

			.response-area pre {
				white-space: pre-wrap;
				word-wrap: break-word;
				font-family: "Courier New", monospace;
				font-size: 0.9em;
			}

			.status-indicator {
				display: inline-block;
				width: 12px;
				height: 12px;
				border-radius: 50%;
				margin-right: 8px;
			}

			.status-success {
				background: #28a745;
			}
			.status-error {
				background: #dc3545;
			}
			.status-loading {
				background: #ffc107;
				animation: pulse 1s infinite;
			}

			@keyframes pulse {
				0% {
					opacity: 1;
				}
				50% {
					opacity: 0.5;
				}
				100% {
					opacity: 1;
				}
			}

			.server-status {
				background: white;
				border-radius: 10px;
				padding: 20px;
				margin-bottom: 30px;
				text-align: center;
			}

			.feature-list {
				background: white;
				border-radius: 10px;
				padding: 20px;
				margin-top: 30px;
			}

			.feature-list h3 {
				color: #667eea;
				margin-bottom: 15px;
			}

			.feature-list ul {
				list-style: none;
			}

			.feature-list li {
				padding: 8px 0;
				border-bottom: 1px solid #eee;
			}

			.feature-list li:before {
				content: "‚úÖ ";
				margin-right: 10px;
			}
		</style>
	</head>
	<body>
		<div class="container">
			<div class="header">
				<h1>ü§ñ AI-Enhanced Clash of Clans Bot</h1>
				<p>Test all AI functionality with this interactive interface</p>
			</div>

			<div class="server-status" id="serverStatus">
				<h3>
					<span class="status-indicator status-loading"></span>Checking server
					status...
				</h3>
			</div>

			<div class="endpoint-grid">
				<div class="endpoint-card">
					<h3>üéØ Base Analysis</h3>
					<p>
						AI analyzes enemy base layout and suggests optimal attack strategy
						with weakness detection.
					</p>
					<button class="test-button" onclick="testEndpoint('analyze-base')">
						Test Base Analysis
					</button>
					<div class="response-area" id="response-analyze-base"></div>
				</div>

				<div class="endpoint-card">
					<h3>‚öîÔ∏è Deployment Optimizer</h3>
					<p>
						AI optimizes troop placement for maximum battle effectiveness and
						strategic advantage.
					</p>
					<button
						class="test-button"
						onclick="testEndpoint('optimize-deployment')"
					>
						Test Deployment
					</button>
					<div class="response-area" id="response-optimize-deployment"></div>
				</div>

				<div class="endpoint-card">
					<h3>üîÑ Strategy Adaptation</h3>
					<p>
						AI provides real-time tactical adjustments during ongoing battles
						based on current conditions.
					</p>
					<button class="test-button" onclick="testEndpoint('adapt-strategy')">
						Test Adaptation
					</button>
					<div class="response-area" id="response-adapt-strategy"></div>
				</div>

				<div class="endpoint-card">
					<h3>üèóÔ∏è Army Optimizer</h3>
					<p>
						AI suggests optimal army composition for specific attack goals and
						base types.
					</p>
					<button class="test-button" onclick="testEndpoint('optimize-army')">
						Test Army Optimizer
					</button>
					<div class="response-area" id="response-optimize-army"></div>
				</div>

				<div class="endpoint-card">
					<h3>üìä Battle Learning</h3>
					<p>
						AI analyzes battle outcomes to improve future attack strategies and
						learn from results.
					</p>
					<button
						class="test-button"
						onclick="testEndpoint('learn-from-battle')"
					>
						Test Learning
					</button>
					<div class="response-area" id="response-learn-from-battle"></div>
				</div>

				<div class="endpoint-card">
					<h3>üó∫Ô∏è Visual Attack Planner</h3>
					<p>
						AI analyzes base images and creates detailed step-by-step attack
						plans with visual recognition.
					</p>
					<button
						class="test-button"
						onclick="testEndpoint('plan-attack-visual')"
					>
						Test Visual Planning
					</button>
					<div class="response-area" id="response-plan-attack-visual"></div>
				</div>
			</div>

			<div class="feature-list">
				<h3>üöÄ Key AI Features Implemented</h3>
				<ul>
					<li>Google Gemini AI integration via Genkit for advanced analysis</li>
					<li>Real-time base weakness detection and exploitation strategies</li>
					<li>Dynamic troop deployment optimization based on base layout</li>
					<li>Adaptive battle strategies that adjust to changing conditions</li>
					<li>Smart army composition suggestions for different attack goals</li>
					<li>
						Machine learning from battle outcomes for continuous improvement
					</li>
					<li>Visual base analysis using image recognition technology</li>
					<li>AutoIt integration for seamless bot communication</li>
					<li>RESTful API design for easy integration and testing</li>
					<li>Comprehensive error handling and logging</li>
				</ul>
			</div>
		</div>

		<script>
			const API_BASE = "http://localhost:3000";

			// Check server status on load
			window.onload = function () {
				checkServerStatus();
			};

			async function checkServerStatus() {
				try {
					const response = await fetch(`${API_BASE}/health`);
					const data = await response.json();

					const statusEl = document.getElementById("serverStatus");
					if (data.status === "ok") {
						statusEl.innerHTML =
							'<h3><span class="status-indicator status-success"></span>AI Server is running successfully!</h3>';
					} else {
						throw new Error("Server not healthy");
					}
				} catch (error) {
					const statusEl = document.getElementById("serverStatus");
					statusEl.innerHTML =
						'<h3><span class="status-indicator status-error"></span>AI Server is not running. Please start it with: npm run dev</h3>';
				}
			}

			async function testEndpoint(endpoint) {
				const button = event.target;
				const responseEl = document.getElementById(`response-${endpoint}`);

				button.disabled = true;
				button.textContent = "Testing...";
				responseEl.innerHTML = "";
				responseEl.classList.remove("show");

				try {
					let requestData = {};

					// Configure request data for each endpoint
					switch (endpoint) {
						case "analyze-base":
							requestData = {
								baseImage:
									"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVR42mNkYPhfDwAChwGA60e6kgAAAABJRU5ErkJggg==",
								troopComposition:
									"Giants: 10, Wizards: 20, Archers: 50, Wall Breakers: 8, Barbarian King, Archer Queen",
								targetResources:
									"Gold and Elixir priority, need 200k+ resources",
								baseLayout:
									"Standard TH10 base with centralized town hall, compartmentalized storages",
								defensePositions: [
									"Archer Tower at (100,150)",
									"Cannon at (200,300)",
								],
								wallConfiguration: "Layered walls with 2 compartments",
							};
							break;
						case "optimize-deployment":
							requestData = {
								baseType: "farming",
								armyComposition: ["20 Giants", "100 Archers", "50 Barbarians"],
								availableSpells: ["Heal", "Rage"],
								targetPriority: "resources",
							};
							break;
						case "adapt-strategy":
							requestData = {
								currentProgress: {
									destructionPercentage: 35,
									starsEarned: 1,
									remainingTime: 120,
								},
								deployedTroops: ["10 Giants", "30 Archers"],
								battleConditions: "Heavy defense fire from north side",
							};
							break;
						case "optimize-army":
							requestData = {
								townHallLevel: 10,
								attackGoal: "farming",
								availableTroops: ["Barbarians", "Archers", "Giants", "Wizards"],
								elixirBudget: 50000,
							};
							break;
						case "learn-from-battle":
							requestData = {
								battleOutcome: {
									starsEarned: 2,
									destructionPercentage: 75,
									resourcesGained: 350000,
								},
								strategyUsed: "Giant-Archer farming strategy",
								baseType: "TH10 farming base",
								successFactors: [
									"Effective giant tanking",
									"Good archer placement",
								],
							};
							break;
						case "plan-attack-visual":
							requestData = {
								baseDescription:
									"TH10 base with central town hall and spread out defenses",
							};
							break;
					}

					const response = await fetch(`${API_BASE}/api/${endpoint}`, {
						method: "POST",
						headers: {
							"Content-Type": "application/json",
						},
						body: JSON.stringify(requestData),
					});

					const data = await response.json();

					responseEl.innerHTML = `<pre>${JSON.stringify(data, null, 2)}</pre>`;
					responseEl.classList.add("show");

					button.textContent = "Success! ‚úÖ";
					setTimeout(() => {
						button.textContent = `Test ${
							endpoint.charAt(0).toUpperCase() +
							endpoint.slice(1).replace("-", " ")
						}`;
						button.disabled = false;
					}, 2000);
				} catch (error) {
					responseEl.innerHTML = `<pre style="color: red;">Error: ${error.message}</pre>`;
					responseEl.classList.add("show");

					button.textContent = "Error ‚ùå";
					setTimeout(() => {
						button.textContent = `Test ${
							endpoint.charAt(0).toUpperCase() +
							endpoint.slice(1).replace("-", " ")
						}`;
						button.disabled = false;
					}, 2000);
				}
			}
		</script>
	</body>
</html>
